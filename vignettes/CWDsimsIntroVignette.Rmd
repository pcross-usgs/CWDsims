---
title: "CWDsims introduction vignette"
author: "Paul C. Cross"
date: "2019-10-2"
output: rmarkdown::html_vignette

vignette: >
  %\VignetteIndexEntry{CWDsims introduction vignette}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE, message=FALSE}
library(knitr)
library(CWDsims)
options(continue=" ")
options(width=60)
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      fig.height = 7,
                      fig.width = 7)
```

The `CWDsims` package was created as a decision-support tool for natural resource managers interested in investigating different scenarios associated with chronic wasting disease (CWD). This tool allows the user to enter parameters for deer or elk vital rates, hunting mortality, and disease transmission and the model will plot the total number of individuals, prevalence, age and sex distribution, and how many deaths were natural, hunting or CWD-related. The user can tailor the model to their species and region of interest by modifying the parameters and starting conditions. The `WDsims` package includes functions to run deterministic and stochastic models, plot the results, and run interactive Shiny apps associated with those CWD model functions.

For information on getting started in R and installing the package, see [Getting Started](#getting-started-in-r). Any use of trade, firm, or product names is for descriptive purposes only and does not imply endorsement by the U.S. Government.

For details on how the CWD models are structured and parameterized see the CWDsims Model vignette. For additional details on the Shiny applications see the CWDsims Shiny vignette

In order to launch the interactive Shiny application on your local machine run the following:

```{r shinyapp, echo=TRUE, eval=FALSE}
library(CWDsims)
launchCWDapp("CWDapp")
```

Some users may be interested in storing output associated with the different models so that more detailed analyses and comparisons can be done. Below is a quick workflow for how to use some of the functions in 'CWDsims'.

```{r workflow, echo=TRUE, eval=FALSE}
# first create a list of parameter values
params <- list(fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.9,
               ad.an.m.sur = 0.9, fawn.repro = 0, juv.repro = 0.6,
               ad.repro = 1, hunt.mort.fawn = 0.01, hunt.mort.juv.f = 0.1,
               hunt.mort.juv.m = 0.1, hunt.mort.ad.f = 0.2, 
               hunt.mort.ad.m = 0.2, ini.fawn.prev = 0.02, ini.juv.prev = 0.03,
               ini.ad.f.prev = 0.04, ini.ad.m.prev = 0.04, n.age.cats = 12, 
               p = 0.43, env.foi = 0, beta.f = 0.15, beta.m = 0.15, theta = 1, 
               n0 = 2000, n.years = 10, rel.risk = 1.0)

# run the deterministic CWD model
out <- cwd_det_model(params)

# plot the totals
plot_tots(out$counts)
```
### Plots

For plotting purposes we sub-sample the entire monthly time series to include only one month per year to avoid displaying the within-year variation.  Total population size is plotted for February. The male:female ratio is sampled in December, and the fawn:doe ratio taken at the end of the biological year in April. Prevalence information is sampled in November. Note that the error bars shown in the stochastic plots are the 5% and 95% quantiles, which may not be estimated well if only a few simulations are run.

### Code and Implementation

Code was written using R version 3.6.1 (R Foundation for Statistical Computing, Vienna, AT; www.R-project.org) and the Shiny package version 1.3.2 (Chang et al. 2017). The main other packages used were:

* reshape2
* popbio
* magrittr
* tidyverse
* cowplot
* ggridges
* knitr
* shinydashboard

All of the source code is available at https://github.com/pcross-usgs/CWD-shiny.

### Citation
This CWD model was developed by the U.S. Geological Survey, Northern Rocky Mountain Science Center, in collaboration with Montana Fish, Wildlife, and Parks.

The tool may be cited as:
Cross, PC and ES Almberg. 2019. CWDsims: An R package for simulating chronic wasting disease scenarios. URL TBD. DOI: 10.5066/P948SF4Q.

*Contact:* For technical assistance or to report outages, please contact pcross@usgs.gov

*Disclaimers*: Although these data have been processed successfully on a computer system at the U.S. Geological Survey (USGS), no warranty expressed or implied is made regarding the display or utility of the data for other purposes, nor on all computer systems, nor shall the act of distribution constitute any such warranty. The USGS or the U.S. Government shall not be held liable for improper or incorrect use of the data described and/or contained herein.

Any use of trade, firm, or product names is for descriptive purposes only and does not imply endorsement by the U.S. Government.

### References
Chang, W, J Cheng, JJ Allaire, Y Xie, and J McPherson 2017. shiny: Web
  Application Framework for R. R package version 1.0.5. https://CRAN.R-project.org/package=shiny

Chang, W, and BB Ribeiro 2018. shinydashboard: Create Dashboards with 'Shiny'.
  R package version 0.7.0. https://CRAN.R-project.org/package=shinydashboard

R Core Team 2018. R: A language and environment for statistical computing. R Foundation for
  Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

Stubben, C.J. and Milligan, B.G. 2007. Estimating and Analyzing Demographic Models Using the popbio Package in R. Journal of Statistical Software 22:11.

Wickham, H 2017. tidyverse: Easily Install and Load the 'Tidyverse'. R package version
  1.2.1. https://CRAN.R-project.org/package=tidyverse

Wickham, H 2007. Reshaping Data with the reshape Package. Journal of Statistical Software, 21(12), 1-20.
URL http://www.jstatsoft.org/v21/i12/.

Wilke, CO 2017. cowplot: Streamlined Plot Theme and Plot Annotations for 'ggplot2'. R
  package version 0.9.2. https://CRAN.R-project.org/package=cowplot

Wilke, CO 2018. ggridges: Ridgeline Plots in 'ggplot2'. R package version 0.5.1.
  https://CRAN.R-project.org/package=ggridges

Xie, Y 2018. knitr: A General-Purpose Package for Dynamic Report Generation in R. R package
  version 1.20.
