<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Paul C. Cross" />


<title>CWDsims model structure vignette</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">CWDsims model structure vignette</h1>
<h4 class="author">Paul C. Cross</h4>
<h4 class="date">2019-10-2</h4>



<div id="model-structure" class="section level2">
<h2>Model structure</h2>
<p>There are four primary simulation models currently available in <code>CWDsims</code> that are deterministic and stochastic versions of one another. All models are based on a discrete monthly timestep that begins in the month of May. The models assume that all births occur in June and all hunting occurs in November. The models track sex and ages of individuals in susceptible (<span class="math inline">\(S\)</span>) and infectious (<span class="math inline">\(I\)</span>) categories to allow for hunting strategies that may target different sex and age groups, and may be preferential to infectious individuals.</p>
<p>Two of the models (cwd_det_model, cwd_stoch_model) assume that males may be more/less likely than females to become infected from any other individual. The shiny application “CWDapp” runs these models interactively. The other two models (cwd_det_model_wiw, cwd_stoch_model_wiw) allows for differential transmission among males, females, males to females and females to males. The “wiw” is short for who-infects-who. The shiny application “CWDapp_wiw” runs these models interactively.</p>
<p>The order of operations in the models is as follows: aging, reproduction, natural mortality, hunting mortality, disease mortality, and disease transmission. We assume that hunting mortality is conditional on first surviving through the natural mortality that occurs in the month of November. Similarly, all disease-induced mortality occurs after natural mortality. Since the timestep of the model is monthly only a small portion of the population is likely to die or be infected per month, thus the ordering events is is unlikely to be a significant issue. Biologically, different forms of mortality are often correlated (e.g., reducing hunting mortality may increase natural mortality due to density dependence and limited resources). However, the models assume that all input parameters are independent of one another. This simplifies user inputs and creates a what-you-input-is-what-you-get property whereby the input of, say, survival rate is constant and does not change over time. Related to this issue the models assume there is no density dependence in any of the survival or reproduction rates. As a result, host population size will increase or decrease exponentially. However, the intent of the model is to be useful over time spans of five to ten years.</p>
<p>To initiate the models, we first calculate the stable stage distribution using a Leslie matrix population model and the user-provided reproduction, natural survival and hunting rates.</p>
<div id="stochasticity" class="section level3">
<h3>Stochasticity</h3>
<p>The stochastic model includes both environmental and demographic stochasticity. For environmental stochasiticity, annual natural and hunting mortality probabilities pulled from a Beta distribution for each year of the simulation. The <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> parameters of the Beta distribution are not familiar to many users, we relate them to the mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span> as follows: <span class="math inline">\(\alpha=\left(\frac{1-\mu}{\sigma^2}-\frac{1}{\mu}\right)\mu^2\)</span> and <span class="math inline">\(\beta=\alpha\left(\frac{1}{\mu}-1\right)\)</span>. For demographic stochasticity, the model includes binomial draws for reproduction, survival, transmission, mortality, and the movement of infected individuals among subcategories. These draws are conducted every timestep where that event may occur (e.g. monthly for survival and transmission, but annually for reproduction). The models currently assume that the transmission coeffi is a fixed constant and not variable from one year to the next.</p>
</div>
<div id="disease-transmission" class="section level3">
<h3>Disease transmission</h3>
<p>The models allow for both direct (individual to individual) and indirect (<em>i.e.</em> environmental) transmission of the pathogen. The probability of direct transmission is generally of the form: <span class="math inline">\(S \left( 1-e^{\left(\frac{\beta I}{N^{\theta}}\right)} \right)\)</span>, where <span class="math inline">\(\beta\)</span> is the transmission coefficient, <span class="math inline">\(I\)</span> and <span class="math inline">\(N\)</span> are the number of infectious individuals and the total number of individuals. <span class="math inline">\(\theta\)</span> determines how disease transmission is a function of the population size. When <span class="math inline">\(\theta = 0\)</span> disease transmission is a function of the number of infected individuals. When <span class="math inline">\(\theta = 1\)</span> disease transmission is a function of the prevalence (<em>i.e.</em> frequency dependent transmission). This general transmission model is modified to be sex specific in two ways. For the cwd_det_model and cwd_stoch_model functions males and females are assumed to become infected at different rates for a given level of infection in the population. This is accomplished by making <span class="math inline">\(\beta\)</span> sex-specific whereby <span class="math inline">\(\beta_{males} = \beta_{females}\gamma\)</span> and the male infection probability becomes <span class="math inline">\(S_{m} \left( 1-e^{\left(\frac{\beta_m I}{N^{\theta}}\right)} \right)\)</span>. For the cwd_det_model_wiw and cwd_stoch_model_wiw functions there is a separate transmission rate within males, within females, from males to females, and from females to males. Here “wiw” is short for who-infects-who. The infection probability then for females is:</p>
<p><span class="math display">\[S_{f} \left( 1 - e^{\frac{\beta_{ff} I_f + \beta_{mf} I_m}{N^{\theta}}} \right)\]</span></p>
<p>where <span class="math inline">\(\beta_{ff}\)</span> is the female-to-female transmission coefficient, <span class="math inline">\(\beta_{mf}\)</span> is the male to female transmission rate.</p>
</div>
<div id="disease-induced-mortality" class="section level3">
<h3>Disease induced mortality</h3>
<p>The likelihood of disease induced mortality for an individual infected with CWD is likely to increase over time after becoming infected. Indivdiuals are unlikely to die due to disease early in their infection, but highly likely to have died after several years. We use a box-car approach to model disease induced mortality so that time until death is <span class="math inline">\(\Gamma\)</span> distribution and roughly bell-shaped. The box-car approach requires the splitting the infectious category into sub-categories. Individuals progressively move through the subcategories at a constant rate and then die when they leave the last category. The current models use 10 sub-categories. Users are unlikely to have an intuition about how the progression through these sub-categories defined by <span class="math inline">\(\rho\)</span> is related to the average time until disease-induced death. As a result, we include a plotting function and tab in the Shiny app to show this relationship.</p>
</div>
<div id="hunting" class="section level3">
<h3>Hunting</h3>
<p>The models allow hunting to preferentially kill positive individuals. The intent is to simulate the possibility of increased hunting in hot-spot areas. The user can input the “relative risk” of hunting positives. The relative risk equals 1 in the case of no preference and positives are hunted in proportion to the background prevalence. Values above 1 indicate that hunters are more likely to kill CWD-positive individuals than would be expected given the prevalence. In the models, the proportion, or probabiltiy, of being hunted as well as the disease prevalence are both known. To distribute the hunter mortality among positives and negatives we can use the 2x2 contingency table of hunted vs not hunted and positive vs negative for disease shown below.</p>
<p><em>Table 1. Contingency table of hunting versus disease prevalence.</em></p>
<table>
<thead>
<tr class="header">
<th>Table 1</th>
<th>hunted</th>
<th>not hunted</th>
<th>totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>positive</td>
<td>A</td>
<td>B</td>
<td>G</td>
</tr>
<tr class="even">
<td>negative</td>
<td>C</td>
<td>D</td>
<td>H</td>
</tr>
<tr class="odd">
<td>total</td>
<td>E</td>
<td>F</td>
<td></td>
</tr>
</tbody>
</table>
<p>In Table 1 the marginal frequencies (<em>i.e.</em> the total number of positives, negatives, hunted and not hunted) are known via user inputs, but the values in the A, B, C, D cells must be calculated. The relative risk of hunting a positive individual is <span class="math inline">\(RR = \frac{A / (A+B)}{C/(C+D)}\)</span>. In this case <span class="math inline">\(RR\)</span>, the prevalence <span class="math inline">\(G/(G+H)\)</span>, and the % hunted <span class="math inline">\(E/(E+F)\)</span> are known such that we can solve for A, B, C, and D. We assume that infected individuals are hunted equally across all sub-categories.</p>
</div>
<div id="additional-parameter-descriptions" class="section level3">
<h3>Additional parameter descriptions</h3>
<p>All survival rates are entered as annual probabilities or proportions depending on whether the model is deterministic or stochastic. Reproductive rates are entered as the number of total offspring per female per year, which can exceed 1 to account for the possibility of twins.</p>
<p>Indirect environmental transmission is the annual probability of being infected from the environment, which we currently assume to be constant for the duration of the simulation.</p>
<p>While the CWD model functions use <span class="math inline">\(\beta\)</span>, in the shiny apps we ask the user to input the direct <span class="math inline">\(R_0\)</span> per year, which we define as the expected number of individuals to be infected by an infected individual in a completely susceptible population in one year. This is because <span class="math inline">\(\theta\)</span> has a strong effect on the overall transmission rate, such that a small increase in <span class="math inline">\(\theta\)</span> would require the large decrease <span class="math inline">\(\beta\)</span> to result in a similar prevalence over time. Based on <span class="math inline">\(\theta\)</span> and the per year direct <span class="math inline">\(R_0\)</span> the shiny app then calculates the appropriate <span class="math inline">\(\beta\)</span> value. Note that direct <span class="math inline">\(R_0\)</span> <em>per year</em> is not the same as the typical <span class="math inline">\(R_0\)</span> which is based on the entire duration of the infectious period, which may be several years. We used this per year <span class="math inline">\(R_0\)</span> because the traditional <span class="math inline">\(R_0\)</span> is a function of the other user-inputs hunting and natural mortality. The direct per year <span class="math inline">\(R_0\)</span> may be less than one and CWD may still increase in the population if individuals are likely to survive with the disease for many years. Also note that the environmental transmission component is not included in that user-input of the direct <span class="math inline">\(R_0\)</span>.</p>
<p>Finally, the relative hunting risk is the ratio of the probability of an infected vs. uninfected individuals being harvested. When the relative risk is greater than one, infected individuals are more likely likely to be harvested relative to the background prevalence, which may be due to the behavior of infected individuals or management strategies that target hot-spots of infection. The parameters in the stochastic model are the same with the exception of the number of simulations to be run.</p>
<p><em>Table 1. Parameters included in the models</em></p>
<table>
<colgroup>
<col width="14%"></col>
<col width="17%"></col>
<col width="10%"></col>
<col width="19%"></col>
<col width="38%"></col>
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Parameter</th>
<th>Symbol</th>
<th>Code name &amp; Default value</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>State variables</td>
<td>Susceptible</td>
<td><span class="math inline">\(S_{i,a}\)</span></td>
<td>St.f, St.m</td>
<td><span class="math inline">\(i\)</span> = sex, <span class="math inline">\(a\)</span> = age</td>
</tr>
<tr class="even">
<td></td>
<td>Infectious</td>
<td><span class="math inline">\(I_{i,a, j}\)</span></td>
<td>It.f, It.m</td>
<td><span class="math inline">\(j\)</span> = infectious sub-category from 1 to 10</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Vital rates</td>
<td>natural survival</td>
<td><span class="math inline">\(\delta_{i,a}\)</span></td>
<td>fawn.an.sur = 0.6, juv.an.sur = 0.8, ad.an.f.sur = 0.95, ad.an.m.sur = 0.9</td>
<td>annual proportions, later converted to monthly</td>
</tr>
<tr class="odd">
<td></td>
<td>reproduction</td>
<td><span class="math inline">\(\alpha_{a&gt;1}\)</span></td>
<td>fawn.repro = 0, juv.repro = 0.6, ad.repro = 1</td>
<td>may be greater than one to account for twins</td>
</tr>
<tr class="even">
<td></td>
<td>hunting mortality</td>
<td><span class="math inline">\(\kappa_{i,a}\)</span></td>
<td>hunt.mort.fawn= 0.01, hunt.mort.juv.f= 0.03, hunt.mort.juv.m = 0.03, hunt.mort.ad.f = 0.1, hunt.mort.ad.m = 0.2</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>disease mortality index</td>
<td><span class="math inline">\(\rho\)</span></td>
<td>p = 0.43</td>
<td>dictates the rate of movement among infectious sub-categories</td>
</tr>
<tr class="even">
<td></td>
<td>hunting relative risk</td>
<td><span class="math inline">\(RR\)</span></td>
<td>rel.risk = 1</td>
<td>increase in hunting mortality associated with being CWD positive</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Transmission</td>
<td>environmental transmission</td>
<td><span class="math inline">\(\epsilon\)</span></td>
<td>env.foi = 0</td>
<td>annual probability from 0 to 1</td>
</tr>
<tr class="odd">
<td></td>
<td>transmission coefficient</td>
<td><span class="math inline">\(\beta_{i}\)</span></td>
<td>beta.f = 0.05, beta.m = 0.1</td>
<td>direct transmission</td>
</tr>
<tr class="even">
<td></td>
<td>relative male infection</td>
<td><span class="math inline">\(\gamma\)</span></td>
<td>2</td>
<td>male transmission = <span class="math inline">\(\beta_m = \beta_f \gamma\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td>female to female transmission</td>
<td><span class="math inline">\(\beta_{ff}\)</span></td>
<td>beta.ff = 0.05</td>
<td>used in “wiw” models</td>
</tr>
<tr class="even">
<td></td>
<td>male to female transmission</td>
<td><span class="math inline">\(\beta_{mf}\)</span></td>
<td>beta.mf</td>
<td>used in “wiw” models</td>
</tr>
<tr class="odd">
<td></td>
<td>female to male transmission</td>
<td><span class="math inline">\(\beta_{fm}\)</span></td>
<td>beta.fm</td>
<td>used in “wiw” models</td>
</tr>
<tr class="even">
<td></td>
<td>male to male transmission</td>
<td><span class="math inline">\(\beta_{mm}\)</span></td>
<td>beta.fm</td>
<td>used in “wiw” models</td>
</tr>
<tr class="odd">
<td></td>
<td>mixing parameter</td>
<td><span class="math inline">\(\theta\)</span></td>
<td>theta = 1</td>
<td><span class="math inline">\(\theta = 1\)</span> is frequency dependent transmission, <span class="math inline">\(\theta = 0\)</span> is density dependent transmission. Can be intermediate.</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Stochasticity</td>
<td>vital rate variation</td>
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>repro.var = 0.005, fawn.sur.var = 0.005, sur.var = 0.005, hunt.var = 0.005</td>
<td>variance for the survival, hunting and reproduction rates</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Intitial conditions</td>
<td>prevalence</td>
<td></td>
<td>ini.fawn.prev = 0.01, ini.juv.prev = 0.02, ini.ad.f.prev = 0.03, ini.ad.m.prev = 0.03</td>
<td>prevalence at the start of the simulation.</td>
</tr>
<tr class="even">
<td></td>
<td>population size</td>
<td></td>
<td>n0 = 1000</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td># of years</td>
<td></td>
<td>n.years = 10</td>
<td># of years to run the simulation</td>
</tr>
<tr class="even">
<td></td>
<td># of simulations</td>
<td></td>
<td>n.sims = 30</td>
<td># of years to run the simulation</td>
</tr>
</tbody>
</table>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
